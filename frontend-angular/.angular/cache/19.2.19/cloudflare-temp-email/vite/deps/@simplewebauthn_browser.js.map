{
  "version": 3,
  "sources": ["../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/bufferToBase64URLString.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/base64URLStringToBuffer.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthn.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/toPublicKeyCredentialDescriptor.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/isValidDomain.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/webAuthnError.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/identifyRegistrationError.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/webAuthnAbortService.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/toAuthenticatorAttachment.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/methods/startRegistration.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthnAutofill.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/identifyAuthenticationError.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/methods/startAuthentication.js", "../../../../../../node_modules/@simplewebauthn/browser/esm/helpers/platformAuthenticatorIsAvailable.js"],
  "sourcesContent": ["/**\n * Convert the given array buffer into a Base64URL-encoded string. Ideal for converting various\n * credential response ArrayBuffers to string for sending back to the server as JSON.\n *\n * Helper method to compliment `base64URLStringToBuffer`\n */\nexport function bufferToBase64URLString(buffer) {\n  const bytes = new Uint8Array(buffer);\n  let str = '';\n  for (const charCode of bytes) {\n    str += String.fromCharCode(charCode);\n  }\n  const base64String = btoa(str);\n  return base64String.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n}", "/**\n * Convert from a Base64URL-encoded string to an Array Buffer. Best used when converting a\n * credential ID from a JSON string to an ArrayBuffer, like in allowCredentials or\n * excludeCredentials\n *\n * Helper method to compliment `bufferToBase64URLString`\n */\nexport function base64URLStringToBuffer(base64URLString) {\n  // Convert from Base64URL to Base64\n  const base64 = base64URLString.replace(/-/g, '+').replace(/_/g, '/');\n  /**\n   * Pad with '=' until it's a multiple of four\n   * (4 - (85 % 4 = 1) = 3) % 4 = 3 padding\n   * (4 - (86 % 4 = 2) = 2) % 4 = 2 padding\n   * (4 - (87 % 4 = 3) = 1) % 4 = 1 padding\n   * (4 - (88 % 4 = 0) = 4) % 4 = 0 padding\n   */\n  const padLength = (4 - base64.length % 4) % 4;\n  const padded = base64.padEnd(base64.length + padLength, '=');\n  // Convert to a binary string\n  const binary = atob(padded);\n  // Convert binary string to buffer\n  const buffer = new ArrayBuffer(binary.length);\n  const bytes = new Uint8Array(buffer);\n  for (let i = 0; i < binary.length; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return buffer;\n}", "/**\n * Determine if the browser is capable of Webauthn\n */\nexport function browserSupportsWebAuthn() {\n  return _browserSupportsWebAuthnInternals.stubThis(globalThis?.PublicKeyCredential !== undefined && typeof globalThis.PublicKeyCredential === 'function');\n}\n/**\n * Make it possible to stub the return value during testing\n * @ignore Don't include this in docs output\n */\nexport const _browserSupportsWebAuthnInternals = {\n  stubThis: value => value\n};", "import { base64URLStringToBuffer } from './base64URLStringToBuffer.js';\nexport function toPublicKeyCredentialDescriptor(descriptor) {\n  const {\n    id\n  } = descriptor;\n  return {\n    ...descriptor,\n    id: base64URLStringToBuffer(id),\n    /**\n     * `descriptor.transports` is an array of our `AuthenticatorTransportFuture` that includes newer\n     * transports that TypeScript's DOM lib is ignorant of. Convince TS that our list of transports\n     * are fine to pass to WebAuthn since browsers will recognize the new value.\n     */\n    transports: descriptor.transports\n  };\n}", "/**\n * A simple test to determine if a hostname is a properly-formatted domain name\n *\n * A \"valid domain\" is defined here: https://url.spec.whatwg.org/#valid-domain\n *\n * Regex sourced from here:\n * https://www.oreilly.com/library/view/regular-expressions-cookbook/9781449327453/ch08s15.html\n */\nexport function isValidDomain(hostname) {\n  return (\n    // Consider localhost valid as well since it's okay wrt Secure Contexts\n    hostname === 'localhost' || /^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}$/i.test(hostname)\n  );\n}", "/**\n * A custom Error used to return a more nuanced error detailing _why_ one of the eight documented\n * errors in the spec was raised after calling `navigator.credentials.create()` or\n * `navigator.credentials.get()`:\n *\n * - `AbortError`\n * - `ConstraintError`\n * - `InvalidStateError`\n * - `NotAllowedError`\n * - `NotSupportedError`\n * - `SecurityError`\n * - `TypeError`\n * - `UnknownError`\n *\n * Error messages were determined through investigation of the spec to determine under which\n * scenarios a given error would be raised.\n */\nexport class WebAuthnError extends Error {\n  constructor({\n    message,\n    code,\n    cause,\n    name\n  }) {\n    // @ts-ignore: help Rollup understand that `cause` is okay to set\n    super(message, {\n      cause\n    });\n    Object.defineProperty(this, \"code\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    this.name = name ?? cause.name;\n    this.code = code;\n  }\n}", "import { isValidDomain } from './isValidDomain.js';\nimport { WebAuthnError } from './webAuthnError.js';\n/**\n * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.create()`\n */\nexport function identifyRegistrationError({\n  error,\n  options\n}) {\n  const {\n    publicKey\n  } = options;\n  if (!publicKey) {\n    throw Error('options was missing required publicKey property');\n  }\n  if (error.name === 'AbortError') {\n    if (options.signal instanceof AbortSignal) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)\n      return new WebAuthnError({\n        message: 'Registration ceremony was sent an abort signal',\n        code: 'ERROR_CEREMONY_ABORTED',\n        cause: error\n      });\n    }\n  } else if (error.name === 'ConstraintError') {\n    if (publicKey.authenticatorSelection?.requireResidentKey === true) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 4)\n      return new WebAuthnError({\n        message: 'Discoverable credentials were required but no available authenticator supported it',\n        code: 'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',\n        cause: error\n      });\n    } else if (\n    // @ts-ignore: `mediation` doesn't yet exist on CredentialCreationOptions but it's possible as of Sept 2024\n    options.mediation === 'conditional' && publicKey.authenticatorSelection?.userVerification === 'required') {\n      // https://w3c.github.io/webauthn/#sctn-createCredential (Step 22.4)\n      return new WebAuthnError({\n        message: 'User verification was required during automatic registration but it could not be performed',\n        code: 'ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE',\n        cause: error\n      });\n    } else if (publicKey.authenticatorSelection?.userVerification === 'required') {\n      // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 5)\n      return new WebAuthnError({\n        message: 'User verification was required but no available authenticator supported it',\n        code: 'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',\n        cause: error\n      });\n    }\n  } else if (error.name === 'InvalidStateError') {\n    // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 20)\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 3)\n    return new WebAuthnError({\n      message: 'The authenticator was previously registered',\n      code: 'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',\n      cause: error\n    });\n  } else if (error.name === 'NotAllowedError') {\n    /**\n     * Pass the error directly through. Platforms are overloading this error beyond what the spec\n     * defines and we don't want to overwrite potentially useful error messages.\n     */\n    return new WebAuthnError({\n      message: error.message,\n      code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n      cause: error\n    });\n  } else if (error.name === 'NotSupportedError') {\n    const validPubKeyCredParams = publicKey.pubKeyCredParams.filter(param => param.type === 'public-key');\n    if (validPubKeyCredParams.length === 0) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 10)\n      return new WebAuthnError({\n        message: 'No entry in pubKeyCredParams was of type \"public-key\"',\n        code: 'ERROR_MALFORMED_PUBKEYCREDPARAMS',\n        cause: error\n      });\n    }\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 2)\n    return new WebAuthnError({\n      message: 'No available authenticator supported any of the specified pubKeyCredParams algorithms',\n      code: 'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',\n      cause: error\n    });\n  } else if (error.name === 'SecurityError') {\n    const effectiveDomain = globalThis.location.hostname;\n    if (!isValidDomain(effectiveDomain)) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 7)\n      return new WebAuthnError({\n        message: `${globalThis.location.hostname} is an invalid domain`,\n        code: 'ERROR_INVALID_DOMAIN',\n        cause: error\n      });\n    } else if (publicKey.rp.id !== effectiveDomain) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 8)\n      return new WebAuthnError({\n        message: `The RP ID \"${publicKey.rp.id}\" is invalid for this domain`,\n        code: 'ERROR_INVALID_RP_ID',\n        cause: error\n      });\n    }\n  } else if (error.name === 'TypeError') {\n    if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 5)\n      return new WebAuthnError({\n        message: 'User ID was not between 1 and 64 characters',\n        code: 'ERROR_INVALID_USER_ID_LENGTH',\n        cause: error\n      });\n    }\n  } else if (error.name === 'UnknownError') {\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 1)\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 8)\n    return new WebAuthnError({\n      message: 'The authenticator was unable to process the specified options, or could not create a new credential',\n      code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n      cause: error\n    });\n  }\n  return error;\n}", "class BaseWebAuthnAbortService {\n  constructor() {\n    Object.defineProperty(this, \"controller\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n  }\n  createNewAbortSignal() {\n    // Abort any existing calls to navigator.credentials.create() or navigator.credentials.get()\n    if (this.controller) {\n      const abortError = new Error('Cancelling existing WebAuthn API call for new one');\n      abortError.name = 'AbortError';\n      this.controller.abort(abortError);\n    }\n    const newController = new AbortController();\n    this.controller = newController;\n    return newController.signal;\n  }\n  cancelCeremony() {\n    if (this.controller) {\n      const abortError = new Error('Manually cancelling existing WebAuthn API call');\n      abortError.name = 'AbortError';\n      this.controller.abort(abortError);\n      this.controller = undefined;\n    }\n  }\n}\n/**\n * A service singleton to help ensure that only a single WebAuthn ceremony is active at a time.\n *\n * Users of **@simplewebauthn/browser** shouldn't typically need to use this, but it can help e.g.\n * developers building projects that use client-side routing to better control the behavior of\n * their UX in response to router navigation events.\n */\nexport const WebAuthnAbortService = new BaseWebAuthnAbortService();", "const attachments = ['cross-platform', 'platform'];\n/**\n * If possible coerce a `string` value into a known `AuthenticatorAttachment`\n */\nexport function toAuthenticatorAttachment(attachment) {\n  if (!attachment) {\n    return;\n  }\n  if (attachments.indexOf(attachment) < 0) {\n    return;\n  }\n  return attachment;\n}", "import { bufferToBase64URLString } from '../helpers/bufferToBase64URLString.js';\nimport { base64URLStringToBuffer } from '../helpers/base64URLStringToBuffer.js';\nimport { browserSupportsWebAuthn } from '../helpers/browserSupportsWebAuthn.js';\nimport { toPublicKeyCredentialDescriptor } from '../helpers/toPublicKeyCredentialDescriptor.js';\nimport { identifyRegistrationError } from '../helpers/identifyRegistrationError.js';\nimport { WebAuthnAbortService } from '../helpers/webAuthnAbortService.js';\nimport { toAuthenticatorAttachment } from '../helpers/toAuthenticatorAttachment.js';\n/**\n * Begin authenticator \"registration\" via WebAuthn attestation\n *\n * @param optionsJSON Output from **@simplewebauthn/server**'s `generateRegistrationOptions()`\n * @param useAutoRegister (Optional) Try to silently create a passkey with the password manager that the user just signed in with. Defaults to `false`.\n */\nexport async function startRegistration(options) {\n  // @ts-ignore: Intentionally check for old call structure to warn about improper API call\n  if (!options.optionsJSON && options.challenge) {\n    console.warn('startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information.');\n    // @ts-ignore: Reassign the options, passed in as a positional argument, to the expected variable\n    options = {\n      optionsJSON: options\n    };\n  }\n  const {\n    optionsJSON,\n    useAutoRegister = false\n  } = options;\n  if (!browserSupportsWebAuthn()) {\n    throw new Error('WebAuthn is not supported in this browser');\n  }\n  // We need to convert some values to Uint8Arrays before passing the credentials to the navigator\n  const publicKey = {\n    ...optionsJSON,\n    challenge: base64URLStringToBuffer(optionsJSON.challenge),\n    user: {\n      ...optionsJSON.user,\n      id: base64URLStringToBuffer(optionsJSON.user.id)\n    },\n    excludeCredentials: optionsJSON.excludeCredentials?.map(toPublicKeyCredentialDescriptor)\n  };\n  // Prepare options for `.create()`\n  const createOptions = {};\n  /**\n   * Try to use conditional create to register a passkey for the user with the password manager\n   * the user just used to authenticate with. The user won't be shown any prominent UI by the\n   * browser.\n   */\n  if (useAutoRegister) {\n    // @ts-ignore: `mediation` doesn't yet exist on CredentialCreationOptions but it's possible as of Sept 2024\n    createOptions.mediation = 'conditional';\n  }\n  // Finalize options\n  createOptions.publicKey = publicKey;\n  // Set up the ability to cancel this request if the user attempts another\n  createOptions.signal = WebAuthnAbortService.createNewAbortSignal();\n  // Wait for the user to complete attestation\n  let credential;\n  try {\n    credential = await navigator.credentials.create(createOptions);\n  } catch (err) {\n    throw identifyRegistrationError({\n      error: err,\n      options: createOptions\n    });\n  }\n  if (!credential) {\n    throw new Error('Registration was not completed');\n  }\n  const {\n    id,\n    rawId,\n    response,\n    type\n  } = credential;\n  // Continue to play it safe with `getTransports()` for now, even when L3 types say it's required\n  let transports = undefined;\n  if (typeof response.getTransports === 'function') {\n    transports = response.getTransports();\n  }\n  // L3 says this is required, but browser and webview support are still not guaranteed.\n  let responsePublicKeyAlgorithm = undefined;\n  if (typeof response.getPublicKeyAlgorithm === 'function') {\n    try {\n      responsePublicKeyAlgorithm = response.getPublicKeyAlgorithm();\n    } catch (error) {\n      warnOnBrokenImplementation('getPublicKeyAlgorithm()', error);\n    }\n  }\n  let responsePublicKey = undefined;\n  if (typeof response.getPublicKey === 'function') {\n    try {\n      const _publicKey = response.getPublicKey();\n      if (_publicKey !== null) {\n        responsePublicKey = bufferToBase64URLString(_publicKey);\n      }\n    } catch (error) {\n      warnOnBrokenImplementation('getPublicKey()', error);\n    }\n  }\n  // L3 says this is required, but browser and webview support are still not guaranteed.\n  let responseAuthenticatorData;\n  if (typeof response.getAuthenticatorData === 'function') {\n    try {\n      responseAuthenticatorData = bufferToBase64URLString(response.getAuthenticatorData());\n    } catch (error) {\n      warnOnBrokenImplementation('getAuthenticatorData()', error);\n    }\n  }\n  return {\n    id,\n    rawId: bufferToBase64URLString(rawId),\n    response: {\n      attestationObject: bufferToBase64URLString(response.attestationObject),\n      clientDataJSON: bufferToBase64URLString(response.clientDataJSON),\n      transports,\n      publicKeyAlgorithm: responsePublicKeyAlgorithm,\n      publicKey: responsePublicKey,\n      authenticatorData: responseAuthenticatorData\n    },\n    type,\n    clientExtensionResults: credential.getClientExtensionResults(),\n    authenticatorAttachment: toAuthenticatorAttachment(credential.authenticatorAttachment)\n  };\n}\n/**\n * Visibly warn when we detect an issue related to a passkey provider intercepting WebAuthn API\n * calls\n */\nfunction warnOnBrokenImplementation(methodName, cause) {\n  console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${methodName}. You should report this error to them.\\n`, cause);\n}", "import { browserSupportsWebAuthn } from './browserSupportsWebAuthn.js';\n/**\n * Determine if the browser supports conditional UI, so that WebAuthn credentials can\n * be shown to the user in the browser's typical password autofill popup.\n */\nexport function browserSupportsWebAuthnAutofill() {\n  if (!browserSupportsWebAuthn()) {\n    return _browserSupportsWebAuthnAutofillInternals.stubThis(new Promise(resolve => resolve(false)));\n  }\n  /**\n   * I don't like the `as unknown` here but there's a `declare var PublicKeyCredential` in\n   * TS' DOM lib that's making it difficult for me to just go `as PublicKeyCredentialFuture` as I\n   * want. I think I'm fine with this for now since it's _supposed_ to be temporary, until TS types\n   * have a chance to catch up.\n   */\n  const globalPublicKeyCredential = globalThis.PublicKeyCredential;\n  if (globalPublicKeyCredential?.isConditionalMediationAvailable === undefined) {\n    return _browserSupportsWebAuthnAutofillInternals.stubThis(new Promise(resolve => resolve(false)));\n  }\n  return _browserSupportsWebAuthnAutofillInternals.stubThis(globalPublicKeyCredential.isConditionalMediationAvailable());\n}\n// Make it possible to stub the return value during testing\nexport const _browserSupportsWebAuthnAutofillInternals = {\n  stubThis: value => value\n};", "import { isValidDomain } from './isValidDomain.js';\nimport { WebAuthnError } from './webAuthnError.js';\n/**\n * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.get()`\n */\nexport function identifyAuthenticationError({\n  error,\n  options\n}) {\n  const {\n    publicKey\n  } = options;\n  if (!publicKey) {\n    throw Error('options was missing required publicKey property');\n  }\n  if (error.name === 'AbortError') {\n    if (options.signal instanceof AbortSignal) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)\n      return new WebAuthnError({\n        message: 'Authentication ceremony was sent an abort signal',\n        code: 'ERROR_CEREMONY_ABORTED',\n        cause: error\n      });\n    }\n  } else if (error.name === 'NotAllowedError') {\n    /**\n     * Pass the error directly through. Platforms are overloading this error beyond what the spec\n     * defines and we don't want to overwrite potentially useful error messages.\n     */\n    return new WebAuthnError({\n      message: error.message,\n      code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n      cause: error\n    });\n  } else if (error.name === 'SecurityError') {\n    const effectiveDomain = globalThis.location.hostname;\n    if (!isValidDomain(effectiveDomain)) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-discover-from-external-source (Step 5)\n      return new WebAuthnError({\n        message: `${globalThis.location.hostname} is an invalid domain`,\n        code: 'ERROR_INVALID_DOMAIN',\n        cause: error\n      });\n    } else if (publicKey.rpId !== effectiveDomain) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-discover-from-external-source (Step 6)\n      return new WebAuthnError({\n        message: `The RP ID \"${publicKey.rpId}\" is invalid for this domain`,\n        code: 'ERROR_INVALID_RP_ID',\n        cause: error\n      });\n    }\n  } else if (error.name === 'UnknownError') {\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-get-assertion (Step 1)\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-get-assertion (Step 12)\n    return new WebAuthnError({\n      message: 'The authenticator was unable to process the specified options, or could not create a new assertion signature',\n      code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n      cause: error\n    });\n  }\n  return error;\n}", "import { bufferToBase64URLString } from '../helpers/bufferToBase64URLString.js';\nimport { base64URLStringToBuffer } from '../helpers/base64URLStringToBuffer.js';\nimport { browserSupportsWebAuthn } from '../helpers/browserSupportsWebAuthn.js';\nimport { browserSupportsWebAuthnAutofill } from '../helpers/browserSupportsWebAuthnAutofill.js';\nimport { toPublicKeyCredentialDescriptor } from '../helpers/toPublicKeyCredentialDescriptor.js';\nimport { identifyAuthenticationError } from '../helpers/identifyAuthenticationError.js';\nimport { WebAuthnAbortService } from '../helpers/webAuthnAbortService.js';\nimport { toAuthenticatorAttachment } from '../helpers/toAuthenticatorAttachment.js';\n/**\n * Begin authenticator \"login\" via WebAuthn assertion\n *\n * @param optionsJSON Output from **@simplewebauthn/server**'s `generateAuthenticationOptions()`\n * @param useBrowserAutofill (Optional) Initialize conditional UI to enable logging in via browser autofill prompts. Defaults to `false`.\n * @param verifyBrowserAutofillInput (Optional) Ensure a suitable `<input>` element is present when `useBrowserAutofill` is `true`. Defaults to `true`.\n */\nexport async function startAuthentication(options) {\n  // @ts-ignore: Intentionally check for old call structure to warn about improper API call\n  if (!options.optionsJSON && options.challenge) {\n    console.warn('startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information.');\n    // @ts-ignore: Reassign the options, passed in as a positional argument, to the expected variable\n    options = {\n      optionsJSON: options\n    };\n  }\n  const {\n    optionsJSON,\n    useBrowserAutofill = false,\n    verifyBrowserAutofillInput = true\n  } = options;\n  if (!browserSupportsWebAuthn()) {\n    throw new Error('WebAuthn is not supported in this browser');\n  }\n  // We need to avoid passing empty array to avoid blocking retrieval\n  // of public key\n  let allowCredentials;\n  if (optionsJSON.allowCredentials?.length !== 0) {\n    allowCredentials = optionsJSON.allowCredentials?.map(toPublicKeyCredentialDescriptor);\n  }\n  // We need to convert some values to Uint8Arrays before passing the credentials to the navigator\n  const publicKey = {\n    ...optionsJSON,\n    challenge: base64URLStringToBuffer(optionsJSON.challenge),\n    allowCredentials\n  };\n  // Prepare options for `.get()`\n  const getOptions = {};\n  /**\n   * Set up the page to prompt the user to select a credential for authentication via the browser's\n   * input autofill mechanism.\n   */\n  if (useBrowserAutofill) {\n    if (!(await browserSupportsWebAuthnAutofill())) {\n      throw Error('Browser does not support WebAuthn autofill');\n    }\n    // Check for an <input> with \"webauthn\" in its `autocomplete` attribute\n    const eligibleInputs = document.querySelectorAll(\"input[autocomplete$='webauthn']\");\n    // WebAuthn autofill requires at least one valid input\n    if (eligibleInputs.length < 1 && verifyBrowserAutofillInput) {\n      throw Error('No <input> with \"webauthn\" as the only or last value in its `autocomplete` attribute was detected');\n    }\n    // `CredentialMediationRequirement` doesn't know about \"conditional\" yet as of\n    // typescript@4.6.3\n    getOptions.mediation = 'conditional';\n    // Conditional UI requires an empty allow list\n    publicKey.allowCredentials = [];\n  }\n  // Finalize options\n  getOptions.publicKey = publicKey;\n  // Set up the ability to cancel this request if the user attempts another\n  getOptions.signal = WebAuthnAbortService.createNewAbortSignal();\n  // Wait for the user to complete assertion\n  let credential;\n  try {\n    credential = await navigator.credentials.get(getOptions);\n  } catch (err) {\n    throw identifyAuthenticationError({\n      error: err,\n      options: getOptions\n    });\n  }\n  if (!credential) {\n    throw new Error('Authentication was not completed');\n  }\n  const {\n    id,\n    rawId,\n    response,\n    type\n  } = credential;\n  let userHandle = undefined;\n  if (response.userHandle) {\n    userHandle = bufferToBase64URLString(response.userHandle);\n  }\n  // Convert values to base64 to make it easier to send back to the server\n  return {\n    id,\n    rawId: bufferToBase64URLString(rawId),\n    response: {\n      authenticatorData: bufferToBase64URLString(response.authenticatorData),\n      clientDataJSON: bufferToBase64URLString(response.clientDataJSON),\n      signature: bufferToBase64URLString(response.signature),\n      userHandle\n    },\n    type,\n    clientExtensionResults: credential.getClientExtensionResults(),\n    authenticatorAttachment: toAuthenticatorAttachment(credential.authenticatorAttachment)\n  };\n}", "import { browserSupportsWebAuthn } from './browserSupportsWebAuthn.js';\n/**\n * Determine whether the browser can communicate with a built-in authenticator, like\n * Touch ID, Android fingerprint scanner, or Windows Hello.\n *\n * This method will _not_ be able to tell you the name of the platform authenticator.\n */\nexport function platformAuthenticatorIsAvailable() {\n  if (!browserSupportsWebAuthn()) {\n    return new Promise(resolve => resolve(false));\n  }\n  return PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();\n}"],
  "mappings": "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",
  "names": []
}
